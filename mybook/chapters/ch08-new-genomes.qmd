# 챕터 8 - 새 게놈 추가하기

이제 새 게놈이 있고 그 게놈의 스케치를 만들 수 있습니다.
이것을 비교에 추가하여 세 게놈이 아닌 *네 게놈*의 비교 행렬을 만들어 봅시다!

새 게놈을 비교에 추가하려면, 스케치 파일을 `compare_genomes`의 `input:`에 추가하기만 하면 됩니다.
그러면 Snakemake가 자동으로 연관된 게놈 파일을 찾아 `sketch_genome`을 실행한 후
(이전 챕터와 같이), `compare_genomes`를 실행합니다.
나머지는 Snakemake가 알아서 처리해 줍니다!

```python
rule sketch_genome:
    input:
        "genomes/{accession}.fna.gz",
    output:
        "{accession}.fna.gz.sig",
    shell: """
        sourmash sketch dna -p k=31 {input} --name-from-first
    """

rule compare_genomes:
    input:
        "GCF_000017325.1.fna.gz.sig",
        "GCF_000020225.1.fna.gz.sig",
        "GCF_000021665.1.fna.gz.sig",
        "GCF_008423265.1.fna.gz.sig",
    output:
        "compare.mat"
    shell: """
        sourmash compare {input} -o {output}
    """

rule plot_comparison:
    message: "sourmash로 모든 입력 게놈을 비교합니다"
    input:
        "compare.mat"
    output:
        "compare.mat.matrix.png"
    shell: """
        sourmash plot {input}
    """

```

이제 `snakemake -j 3 plot_comparison`을 실행하면 4x4 행렬이 담긴
`compare.mat.matrix.png` 파일이 생성됩니다! (그림 참고)

![게놈 4개의 4x4 비교 행렬](images/2023-snakemake-slithering-section-2-4x4-mat.png)

워크플로 다이어그램도 네 번째 게놈을 포함하여 확장되었습니다!

![중간 단계 작업 그래프 (4개 게놈)](images/2023-snakemake-slithering-section-2-interm4-dag.png)
